"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{86987:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(15861),c=n(87757),o=n.n(c),a=n(67294),i=n(66468),s=n(36485),u=n(85893);function l(e){var t=e.add,n=e.fetchFunction,c=e.customMaxSize,l=(0,a.useRef)(null),f=(0,a.useState)(""),h=f[0],d=f[1],p=(0,a.useState)(!1),x=p[0],v=p[1],m=(0,a.useState)(!1),b=m[0],g=m[1],w=null,j=function(e){for(var t=0;t<e.length;t++)if(!e[t].name.includes("."))return!0;return!1},k=function(){var e=(0,r.Z)(o().mark((function e(r){var a,s,u,l,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r||!r.length){e.next=23;break}if(!(0,i.u)(r,c)){e.next=22;break}if(d(""),j(r)){e.next=19;break}if(!n){e.next=14;break}for(v(!0),a=new FormData,s=0;r.length>s;s++)a.append("files",r[s]);return e.next=10,n(a);case 10:null!==(u=e.sent)&&void 0!==u&&u.status?(t(u.data),v(!1)):(d(u.message||"Something went wrong!"),v(!1)),e.next=17;break;case 14:for(l=[],f=0;r.length>f;f++)l.push(r[f]);t(l);case 17:e.next=20;break;case 19:d("Your files have folder!");case 20:e.next=23;break;case 22:d("Your file weight more than ".concat(c||20," MB"));case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(e){e.preventDefault(),e.stopPropagation()};return(0,u.jsxs)("div",{onDrop:function(e){y(e);var t=e.dataTransfer.files;k(t),g(!1)},onDragEnter:function(e){y(e),w=e.target},onDragOver:function(e){y(e),g(!0)},onDragLeave:function(e){w==e.target&&(y(e),g(!1))},className:"p-5 myShadow rounded relative",children:[(0,u.jsx)("input",{type:"file",ref:l,className:"w-0",onChange:function(e){var t=e.currentTarget.files;k(t)},multiple:!0}),(0,u.jsx)("button",{onClick:function(){var e;null===(e=l.current)||void 0===e||e.click()},className:"text-blue-600 hover:text-blue-500 hover:cursor-pointer",children:"Select a file"}),(0,u.jsx)("span",{children:" or drag in form"}),h?(0,u.jsx)("p",{className:"text-red-500 text-sm",children:h}):(0,u.jsxs)("p",{className:"text-gray-400 text-sm",children:["PNG, jpg, gif files up to ",c||20," MB in size are available for upload"]}),b&&(0,u.jsx)("div",{className:"absolute w-full h-full flex items-center justify-center top-0 left-0 bg-white border-2 border-black border-dashed rounded",children:(0,u.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48px",viewBox:"0 0 24 24",width:"48px",fill:"#000000",children:[(0,u.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,u.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})]})}),x&&(0,u.jsx)("div",{className:"absolute left-0 top-0 w-full h-full bg-white bg-opacity-80 flex items-center justify-center",children:(0,u.jsx)(s.Z,{})})]})}},38551:function(e,t,n){n.d(t,{Z:function(){return g}});var r=n(15861),c=n(87757),o=n.n(c),a=n(67294),i=n(68428),s=n(8798),u=n(2147);function l(e,t){return fetch(u.z+"/userfiles/"+t+"/"+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){return e.blob()})).then((function(t){var n=document.createElement("a");n.href=URL.createObjectURL(t),n.setAttribute("download",e),n.click()}))}function f(e,t,n){return fetch("".concat(u.z,"/files/").concat(t,"/").concat(n,"/").concat(e),{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){return e.blob()})).then((function(t){var n=document.createElement("a");n.href=URL.createObjectURL(t),n.setAttribute("download",e),n.click()}))}var h=n(36485);function d(e,t,n){return p.apply(this,arguments)}function p(){return(p=(0,r.Z)(o().mark((function e(t,n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat(u.z,"/files/").concat(n,"/").concat(r,"/").concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){return e.blob()})).then((function(e){window.open(URL.createObjectURL(e))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t){return v.apply(this,arguments)}function v(){return(v=(0,r.Z)(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch(u.z+"/userfiles/"+n+"/"+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){return e.blob()})).then((function(e){window.open(URL.createObjectURL(e))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(85893);function b(e){var t=e.file,n=t.name,c=t.size,u=e.checkIsUserAdmin,p=e.subject,v=e.remove,b=e.removeFetchFunction,g=(0,a.useContext)(s.UserContext).user,w=g.role,j=g.username,k=g.school_class,y=(0,a.useState)(!1),O=y[0],z=y[1],N=(0,a.useState)(null),S=N[0],Z=N[1],L=(0,i.Z)(c),B=function(){var e=(0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z(null),z(!0),!b){e.next=8;break}return e.next=5,b(n);case 5:"OK"===(t=e.sent)?v(n):Z(t),z(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.location.href.match("/home")){e.next=5;break}return e.next=3,l(n,j);case 3:e.next=7;break;case 5:return e.next=7,f(n,k,p);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.location.href.match("/home")?x(n,j):d(n,k,p);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,m.jsxs)("div",{className:"relative p-3 lg:p-5 myShadow rounded flex gap-4 items-center",children:[(0,m.jsx)("button",{onClick:D,children:(0,m.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"28px",viewBox:"0 0 24 24",width:"28px",fill:"#2563eb",children:[(0,m.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,m.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"})]})}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("p",{className:"break-all",children:[(0,m.jsx)("span",{children:n}),(0,m.jsx)("span",{className:"text-gray-400 ml-2",children:L})]}),(!u||"admin"===w)&&(0,m.jsx)("button",{className:"text-blue-600 hover:text-blue-500 hover:cursor-pointer mt-2",onClick:B,children:"Delete a file"}),S&&(0,m.jsx)("p",{className:"text-red-500",children:S})]}),(0,m.jsx)("button",{className:"ml-auto bg-gray-100 hover:bg-gray-200 p-4 rounded-full flex items-center justify-center hover:cursor-pointer",onClick:M,children:(0,m.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",enableBackground:"new 0 0 24 24",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#4158D0",children:[(0,m.jsx)("g",{children:(0,m.jsx)("rect",{fill:"none",height:"24",width:"24"})}),(0,m.jsx)("g",{children:(0,m.jsx)("path",{d:"M18,15v3H6v-3H4v3c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2v-3H18z M17,11l-1.41-1.41L13,12.17V4h-2v8.17L8.41,9.59L7,11l5,5 L17,11z"})})]})}),O&&(0,m.jsx)("div",{className:"absolute left-0 top-0 w-full h-full bg-white bg-opacity-80 flex items-center justify-center",children:(0,m.jsx)(h.Z,{})})]})}function g(e){var t=e.files,n=e.subject,r=e.checkIsUserAdmin,c=void 0!==r&&r,o=e.remove,a=e.removeFetchFunction;return(0,m.jsx)("div",{className:"flex flex-col xl:grid grid-cols-2 gap-3 lg:gap-9 py-3",children:t.map((function(e,t){return(0,m.jsx)(b,{file:e,subject:n,checkIsUserAdmin:c,remove:o,removeFetchFunction:a},t)}))})}},36485:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(85893);function c(){return(0,r.jsx)("div",{className:"relative animate-spin w-16 h-16 border-8 border-blue-500 rounded-full",children:(0,r.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-y-full -translate-x-1/2 w-2 h-2 bg-white"})})}},34433:function(e,t,n){var r=n(4942),c=n(67294),o=n(8798),a=n(11163),i=n(85893);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.Z=function(e){return function(t){var n=(0,a.useRouter)(),u=(0,c.useContext)(o.AuthContext).isLoggedIn;return(0,c.useEffect)((function(){u||n.replace("/login")})),u?(0,i.jsx)(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t)):null}}},66468:function(e,t,n){n.d(t,{u:function(){return r}});var r=function(e,t){for(var n=0,r=1048576*(t||20),c=0;c<e.length;c++)n+=e[c].size;return!(n>r)}},68428:function(e,t,n){function r(e){var t=Math.round(e/1048576),n=Math.round(e/1024);return t?t+" MB":n?n+" KB":e+" B"}n.d(t,{Z:function(){return r}})},94741:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(2147);function c(e){return fetch(r.z+"/subjects/"+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){return e.json()}))}}}]);